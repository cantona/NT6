// Room:/d/welcome/regroom.c
// Updated by Lonely (08/11/2002)

#include <ansi.h>
inherit ROOM;
int do_register(string arg);

void create()
{
        set("short", "æ³¥æ½­è¨»å†Šå®¤");
        set("long", "\né€™è£æ˜¯æ–°ç©å®¶é€²è¡Œè¨»å†Šçš„åœ°æ–¹ï¼Œè«‹æ‚¨ä½¿ç”¨æŒ‡ä»¤ " HIC "register " NOR "åŠ ä¸Šä½ çš„å®Œ\n"
                    "æ•´åŠçœŸå¯¦" HIC " email " NOR "åœ°å€é€²è¡Œè¨»å†Šã€‚\n\n"
                    "    è«‹å‹™å¿…èªçœŸè¨»å†Šä½ çš„é›»å­éƒµä»¶åœ°å€ï¼Œ" HIR "é›»å­éƒµä»¶åœ°å€æ˜¯ä¿éšœä½ ä¸€åˆ‡\n"
                    "æ¬Šç›Šçš„ä¾æ“š" NOR "ï¼ŒåŒ…æ‹¬ä½ å¯†ç¢¼çš„ä¸Ÿå¤±æƒ…æ³ä¸‹ï¼Œæˆ‘å€‘é€šéä½ è¨»å†Šçš„ä¿¡ç®±ä¾†ç¢º\n"
                    "èªä½ çš„èº«ä»½å’Œæ­¸é‚„ä½ çš„å¯†ç¢¼ã€‚\n\n"

                    "ç¾åœ¨ï¼Œè«‹è¼¸å…¥" HIW " register æ‚¨çš„emailåœ°å€\n\n" NOR);


        set("item_desc", ([
        "sign":
"\t     [1;33mæœ‰é—œé›»å­éƒµä»¶è¨»å†Šçš„å¹¾é»èª¬æ˜[0m
[37mï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼[0m
é¦–å…ˆè«‹ä½ ä»”ç´°æª¢æŸ¥è¨»å†Šå‘½ä»¤è£è¼¸å…¥çš„é›»å­éƒµä»¶åœ°å€æ˜¯å¦æ­£ç¢ºï¼

é€™å€‹éŠæˆ²çš„è¨»å†Šéç¨‹æ˜¯ç”±æ©Ÿå™¨è‡ªå‹•å®Œæˆçš„ï¼Œåœ¨ä½ é‚„æ²’æœ‰é›¢é–‹
éŠæˆ²çš„æ™‚å€™è¨»å†Šä¿¡å°±å·²ç¶“ç™¼å‡ºäº†ã€‚å¦‚æœè¨»å†Šä¿¡æœªèƒ½æ­£ç¢ºç™¼å‡º
æœƒæç¤ºä½ å¾æ–°è¼¸å…¥è¨»å†Šå‘½ä»¤ï¼Œåªæœ‰æ­£ç¢ºç™¼å‡ºä»¥å¾Œæ‰æœƒå°‡è¨»å†Š
ç©å®¶æ–·ç·šã€‚
ä½ æ”¶åˆ°çš„æ™‚é–“æ˜¯æœ‰ä½ çš„éƒµä»¶æœå‹™æä¾›è€…æ±ºå®šçš„ï¼Œå¦‚æœä»–å€‘è½‰
ä¿¡çš„æ™‚é–“å¿«ï¼Œæ­£å¸¸æƒ…æ³ä¸‹ä½ æ‡‰ç•¶åœ¨[1;33m10[0mç§’é˜ä¹‹å…§æ”¶åˆ°ã€‚ä¹Ÿå°±æ˜¯
ä½ é—œä¸Š zMudçª—å£æ‰“é–‹éƒµä»¶ç¨‹åºï¼Œå°±æ‡‰ç•¶èƒ½æ”¶åˆ°äº†ã€‚æœ€é²[1;33m1-2[0m
å€‹å°æ™‚ä¹Ÿæ‡‰ç•¶æ”¶åˆ°ã€‚
æˆ‘å€‘çš„éŠæˆ²çµ¦ç©å®¶ç•™äº† [1;36m48[0m å€‹å°æ™‚çš„æ”¶ä¿¡æ™‚é–“æ‡‰ç•¶æ˜¯å¾ˆå……åˆ†
çš„ã€‚å¦‚æœåœ¨é€™æ®µæ™‚é–“å…§é‚„æœªèƒ½æ”¶åˆ°æˆ‘å€‘ç™¼çµ¦ä½ çš„ä¿¡ï¼Œå»ºè­°ä½ 
æ›ä¸€å€‹è½‰ä¿¡å¿«çš„éƒµä»¶æœå‹™æä¾›è€…å†æ¬¡ç”³è«‹ï¼Œæˆ–è€…å‘ä½ çš„éƒµä»¶
æœå‹™æä¾›è€…é€²è¡Œè«®è©¢ã€‚

æ„Ÿè¬ä½ å°é€™å€‹éŠæˆ²çš„é—œæ³¨ã€‚  (æ³¨ï¼šéƒµä»¶è¨»å†Šåˆ¶åº¦æš«ç·©å¯¦è¡Œ)
[37mï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼[0m
                               \t\t[1;36m" + MUD_NAME + "å·«å¸«çµ„[0m\n"
        ]));


        set("no_fight", 1);
        set("no_magic", 1);
        set("no_steal", 1);
        set("no_beg", 1);   
        // set("valid_startroom", 1); 
     
        setup();
}

void init()
{
        add_action("do_register", "register");
        add_action("do_register", "zhuce");
}

int do_register(string arg)
{
        object me = this_player();
        string mail;
        string msg;
        
        if (! arg|| strsrch(arg, "@") == -1 
        || sscanf(arg, "%*s@%*s.%*s") != 3 
        || strsrch(arg, ",") != -1)
                return notify_fail("é›»å­éƒµä»¶åœ°å€å¿…é ˆæ˜¯ "
                                   "player@me.com æ ¼å¼ã€‚\n");
        else
        {
                mail = arg;
                set("email", mail, me);

                msg=query("name", me)+"ï¼ˆ"+query("id", me)+"ï¼‰ï¼š\n\n";

                msg += "    æ­¡è¿é€²å…¥æ³¥æ½­çš„ä¸–ç•Œï¼Œå¾é€™ä¸€åˆ»èµ·æ‚¨å°‡æœ‰æ©Ÿæœƒé«”é©—åˆ°å…¶ä»–MUD ç„¡\n" +
                       "æ³•å¸¶çµ¦æ‚¨çš„å¿«æ¨‚ã€‚\n";
                msg += "    å¦‚æœæ‚¨æ˜¯ä¸€å€‹å–œæ­¡èŠå¤©çš„äººï¼Œé€™è£æœ‰æ›´å¤šï¼Œæ›´æœ‰è¶£ï¼Œä¹Ÿæ›´å…¨é¢çš„\n" +
                       "emote å¯ä»¥è®“æ‚¨ç›¡æƒ…äº«æ¨‚ï¼Œå¬‰ç¬‘æ€’ç½µï¼Œå®Œå…¨ä¸å¿…è² è²¬ä»»ã€‚\n";
                msg += "    å¦‚æœæ‚¨æ˜¯ä¸€å€‹å–œæ­¡ç·´åŠŸçš„äººï¼Œé€™è£çš„é–€æ´¾ä¹‹é–“å°‡é”åˆ°æœ€å¤§é™åº¦çš„\n" +
                       "å¹³è¡¡ï¼Œå¤šæ¨£çš„ä»»å‹™ç³»çµ±å¯ä»¥è®“æ‚¨æ¯”è¼ƒé †åˆ©çš„æˆå°±ä¸€ä»£å®—å¸«ã€‚\n";
                msg += "    å¦‚æœå¾ˆä¸å·§çš„æ‚¨æ˜¯ä¸€å€‹åˆ©æ…¾è–°å¿ƒçš„äººï¼Œé€™è£çš„å®˜è·ç³»çµ±ä¸€å®šå¯ä»¥\n" +
                       "æ»¿è¶³æ‚¨æ“”ç•¶å…µé¦¬å¤§å°‡è»çš„æ…¾æœ›ã€‚\n";
                msg += "    å¦‚æœæ‚¨æ˜¯ä¸€å€‹æ¸´æœ›ç”Ÿæ´»çš„äººï¼Œæ‚¨å¯ä»¥åœ¨é€™è£å¨¶å¦»ç”Ÿå­ï¼Œè²·æˆ¿é‡£é­š\n" +
                       "ç‚ºæ¨‚ï¼Œäº«å—é‚£ä¸€ä»½ä¸–å¤–é«˜äººçš„æ¬éœèˆ‡æ·¡é›…ã€‚\n";
                msg += "    å¦‚æœæ‚¨å°MUD éŠæˆ²æ„Ÿåˆ°å¾ˆé™Œç”Ÿï¼Œæˆ‘å€‘çš„æ³¥æ½­ä¸­æœ‰å®Œå–„çš„æ–°æ‰‹æŒ‡å¼•\n" +
                       "ç³»çµ±ï¼Œä¸¦è¨­æœ‰å°ˆé–€çš„æ–°äººå°å¸«å°å„ä½æ–°ç©å®¶é€²è¡ŒæŒ‡å°ã€‚\n";
                msg += "    åŒæ™‚ï¼Œé€™è£åš´æ ¼è²«å¾¹â€œå…¬å¹³ï¼Œå…¬æ­£ï¼Œå…¬é–‹â€å…­å­—çœŸè¨€ï¼ŒåŠªåŠ›ç‚ºå„\n" +
                       "ä½ç©å®¶æ‰“é€ ä¸€ç‰‡ç´”æ·¨çš„éŠæˆ²å¤©ç©ºã€‚\n";
                msg += "    æ›´å¤šçš„éŠæˆ²ç‰¹è‰²æ‚¨å¯ä»¥è¨ªå•æˆ‘å€‘çš„ç¶²ç«™www.chinesemud.orgï¼Œæˆ–\n" +
                       "è€…ç›´æ¥é€²å…¥éŠæˆ²å…§éƒ¨ç”¨helpå‘½ä»¤é€²è¡ŒæŸ¥è©¢ã€‚å¦‚æœæ‚¨å°æˆ‘å€‘çš„éŠæˆ²æœ‰ä»»\n" +
                       "ä½•æ„è¦‹ï¼Œæ‚¨å¯ä»¥åœ¨éŠæˆ²å…§éƒ¨çš„ç•™è¨€æ¿ä¸Šç•™è¨€ï¼Œæˆ–è€…ç›´æ¥ç™»é™¸æˆ‘å€‘çš„è«–\n" +
                       "å£‡bbs.chinesemud.orgã€‚\n";
                msg += "    å†æ¬¡è¡·å¿ƒæ„Ÿè¬æ‚¨åƒèˆ‡æˆ‘å€‘çš„éŠæˆ²ï¼Œåœ¨æ­¤æ³¥æ½­çš„å·«å¸«å€‘å°‡ä»¥æœ€å¤§çš„\n" +
                       "ç†±æƒ…å›å ±æ‚¨å°æˆ‘å€‘çš„æ”¯æŒã€‚\n";
                msg += "    è¬è¬ï¼\n\n";

                msg += "ã€€ã€€        ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€                æ³¥æ½­å·«å¸«å·¥ä½œç¾£\n";

                /*
                if (! MAIL_D->queue_mail(me, "nitan@chinesemud.org",
                        query("email", me),"æ„Ÿè¬æ‚¨å…‰è‡¨æ³¥æ½­ç¶²çµ¡éŠæˆ²",msg) )
                {
                        tell_object(me, query_fail_msg());
                        tell_object(me, "ç™¼é€è¨»å†Šéƒµä»¶å¤±æ•—ï¼Œè«‹è¨»å†Šä½ æ­£ç¢ºçš„éƒµä»¶åœ°å€ï¼\n");
                        return 1;
                }
                */
                
                set("registered", 1, me);
                /*
                tell_object(me, "\næœ‰ä¸€å°éƒµä»¶å·²æ ¹æ“šæ‚¨ç™»è¨˜çš„åœ°å€ç™¼å¾€\n\n" +
                                ""+HIW+query("email", me)+NOR+"\n\nè«‹æ‚¨"
                                HIG "äºŒåˆ†é˜" NOR "å¾Œæª¢æŸ¥æ‚¨çš„é›»å­éƒµä»¶ä¿¡ç®±ã€‚\n");
                */
                tell_object(me, HIR "\nç¥æ‚¨åœ¨æ³¥æ½­ç©çš„æ„‰å¿«ï¼:)\n\n" NOR);
                message("vision", "åªè¦‹ç™½å…‰ä¸€é–ƒï¼Œ"+me->name()+"æ¶ˆå¤±äº†ã€‚\n", environment(me), ({me}) ); 
                // SMTP_D->send_mail(me,mail);
                me->move("/d/register/entry");
                message("vision", "ä½ å¿½ç„¶ç™¼ç¾å‰é¢å¤šäº†ä¸€å€‹äººå½±ã€‚\n", environment(me), me);
                
                return 1;
        }
}
