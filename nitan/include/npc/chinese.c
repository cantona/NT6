// chinese name

#include "name.h"

mapping get_cn_name();
mapping cn_sname = ([
//笢貌等俷
        "梊" : "zhao",
        "" : "qian",
        "呤" : "sun",
        "燠" : "li",
        "笚" : "zhou",
        "挔" : "wu",
        "痑" : "zheng",
        "卼" : "wang",
        "瑛" : "feng",
        "麻" : "chen",
        "鵊" : "chu",
        "怹" : "wei",
        "蔓" : "jiang",
        "朻" : "shen",
        "澈" : "han",
        "栦" : "yang",
        "紾" : "zhu",
        "" : "qin",
        "蚧" : "you",
        "勍" : "xu",
        "睡" : "he",
        "臍" : "lv",
        "囥" : "shi",
        "桲" : "zhang",
        "謂" : "kong",
        "羚" : "cao",
        "旆" : "yan",
        "貌" : "hua",
        "踢" : "jin",
        "庥" : "wei",
        "枎" : "tao",
        "蔽" : "jiang",
        "" : "qi",
        "郅" : "xie",
        "軜" : "zou",
        "郟" : "yu",
        "啡" : "bo",
        "阨" : "shui",
        "鬄" : "dou",
        "梒" : "zhang",
        "堁" : "yun",
        "劼" : "su",
        "攣" : "pan",
        "賅" : "ge",
        "瘃" : "xi",
        "毓" : "fan",
        "鱖" : "peng",
        "檔" : "lang",
        "糧" : "lu",
        "峇" : "wei",
        "鎮" : "ma",
        "醮" : "miao",
        "瘀" : "feng",
        "豪" : "hua",
        "源" : "fang",
        "" : "ren",
        "圇" : "yuan",
        "霞" : "liu",
        "腌" : "deng",
        "惚" : "bao",
        "妢" : "shi",
        "昄" : "tang",
        "煤" : "fei",
        "螳" : "lian",
        "嶍" : "cen",
        "悁" : "xue",
        "濘" : "lei",
        "種" : "he",
        "懼" : "ni",
        "抸" : "tang",
        "枘" : "teng",
        "秜" : "yin",
        "蹕" : "luo",
        "貌" : "hua",
        "甄" : "hao",
        "絑" : "wu",
        "假" : "an",
        "都" : "chang",
        "氈" : "le",
        "奀" : "shi",
        "葆" : "fu",
        "" : "pi",
        "勗" : "bian",
        "" : "qi",
        "艙" : "kang",
        "斪" : "wu",
        "豻" : "yu",
        "啋" : "yuan",
        "眺" : "bu",
        "嘈" : "gu",
        "" : "ping",
        "酴" : "huang",
        "睿" : "he",
        "鐃" : "mu",
        "苳" : "xiao",
        "窇" : "yin",
        "狾" : "yao",
        "幵" : "shao",
        "匽" : "wang",
        "" : "qi",
        "禱" : "mao",
        "迿" : "yu",
        "菸" : "di",
        "譙" : "mi",
        "探" : "bei",
        "隴" : "ming",
        "數" : "ji",
        "睦" : "fu",
        "傖" : "cheng",
        "渴" : "dai",
        "抶" : "tan",
        "冼" : "song",
        "矇" : "mao",
        "籣" : "pang",
        "倱" : "xiong",
        "槨" : "ji",
        "戺" : "shu",
        "" : "qu",
        "砐" : "xiang",
        "蛅" : "zhu",
        "雁" : "dong",
        "褽" : "liang",
        "榆" : "fan",
        "綸" : "hu",
        "錘" : "ling",
        "齊" : "huo",
        "訒" : "yu",
        "勀" : "wan",
        "盓" : "zhi",
        "螞" : "ke",
        "篜" : "jiu",
        "奪" : "guan",
        "竅" : "lu",
        "荎" : "ying",
        "喫" : "qiu",
        "綜" : "hou",
        "埬" : "yue",
        "邟" : "shuai",
        "譴" : "ning",
        "嗷" : "gu",
        "奠" : "chu",
        "輩" : "jin",
        "晑" : "yan",
        "楊" : "fa",
        "蛦" : "yan",
        "芨" : "tu",
        "" : "qin",
        "僇" : "duan",
        "寥" : "gui",
        "漆" : "hai",
        "錶" : "kuang",
        "" : "qin",
        "妀" : "shang",
        "觸" : "mou",
        "欿" : "she",
        "蘋" : "mo",
        "慇" : "ha",
        "爛" : "nian",
        "栠" : "yang",
        "晼" : "tong",
        "晟" : "yan",
        "嵎" : "kuai",
        "笘" : "zhong",
        "跁" : "zong",
        "輿" : "lin",
        "坒" : "shi",
        "隸" : "liu",
        "剢" : "xu",
        "廖" : "guo",
        "祊" : "xiao",
        "最" : "cheng",
        "葭" : "fu",
        "崠" : "zeng",
        "絆" : "cai",
        "樂" : "jia",
        "間" : "ding",
        "珔" : "ye",
        "債" : "du",
        "狦" : "xia",
        "泬" : "tian",
        "抪" : "tan",
        "蹉" : "liao",
        "翻" : "lu",
        "啞" : "bai",
        "殖" : "cui",
        "" : "qiu",
        "蔬" : "jiang",
        "妢" : "shi",
        "綜" : "hou",
        "譁" : "meng",
        "韓" : "long",
        "燮" : "li",
        "眢" : "yi",
        "挕" : "wu",
        "" : "qiao",
        "懇" : "lai",
        "麂" : "gong",
        "恅" : "wen",

//笢貌葩俷
        "陲源" : "dongfang",
        "黃嗽" : "dugu",
        "躅" : "murong",
        "韁栠" : "ouyang",
        "侗鎮" : "sima",
        "昹藷" : "ximen",
        "徆喧" : "yuchi",
        "酗呤" : "zhangsun",
        "絊賅" : "zhuge",
        "奻夥" : "shangguan",
        "狦綜" : "xiahou",
        "恓" : "wenren",
        "銘蒂" : "huangfu",
        "憯怢" : "tantai",
        "鼠笥" : "gongzhi",
        "晷衾" : "chunyu",
        "扠芡" : "shentu",
        "鼠呤" : "gongsun",
        "鼠栺" : "gongyang",
        "唄埢" : "xuanyuan",
        "鍔緒" : "linghu",
        "笘燭" : "zhongli",
        "迻恅" : "yuwen",
        "躅" : "murong",
        "笯呤" : "zhongsun",
        "侗芺" : "situ",
        "侗諾" : "sikong",
        "傷躂" : "duanmu",
        "鼠謎" : "gongliang",
        "啃爵" : "baili",
        "陲廖" : "dongguo",
        "珅衾" : "xianyu",
        "鰍廖" : "nanguo",
        "網晊" : "huyan",
        "栺忕" : "yangshe",
        "陲藷" : "dongmen",
        "馨擘" : "nalan",
        "鰍夥" : "nanguan",
        "鰍僧" : "nangong",
        "阹匿" : "tuoba",
        "俇晇" : "wanyan",
        "珖薺" : "yelv",
]);

mapping cn_pname = ([
        "a"    : "陝",
        "ai"   : "馬鬲飢高偺除閮磃睧",
        "an"   : "假蘾硨偉偽跅蟜",
        "ao"   : "兜偭偷罶倏驉",
        "ang"  : "偕偵偎",
        "ba"   : "啦啪區鼵",
        "bai"  : "啞唱",
        "ban"  : "啤唯啜",
        "bang" : "堊",
        "bei"  : "控捷探掘",
        "biao" : "桶梓梵鴟鴙",
        "bian" : "晚勗袲碴",
        "bin"  : "棄梅梃",
        "bing" : "甜條梡梂殺渳",
        "bu"   : "祭祥窒票硎",
        "cao"  : "羚翌紱儋",
        "cai"  : "符粒第笙",
        "cang" : "紳累終徫",
        "chang": "酗荻釣冑釦釧篟",
        "chao" : "閉陰陴陳",
        "chen" : "魚頃鳥鹵麥鉡撌徫",
        "cheng": "剴傘堜創勞跖闃割糗",
        "chi"  : "喧厥喀喪喜喊喋",
        "chuan": "捶漍換樝",
        "ci"   : "森棒棵棕棗棹檖觕",
        "da"   : "湮湛",
        "de"   : "肅腕",
        "ding" : "隋隅縪鏺謜霝",
        "du"   : "黃飲僅飭鬷",
        "dong" : "陲雇集薶廒",
        "dou"  : "須項鬄",
        "duo"  : "嗣嗤嗆礱",
        "fa"   : "楊楷椰楨楔極",
        "fan"  : "歇毀滓楞猻楛楫鼐",
        "fang" : "源溼絟P溘溶",
        "fei"  : "滄傱麭",
        "feng" : "瑞瘀猾猿畸瑯瑕瑟",
        "fu"   : "腦痲睫艇傰",
        "gao"  : "詢詭菗訾詨睅褆篚",
        "gang" : "詩賹試詼詣詳",
        "gong" : "鼠馱僧髡鳩騿",
        "guan" : "嫗夥嫩夢蹣",
        "guang": "嫖嫘",
        "hai"  : "漆漸",
        "hao"  : "瘍瘋薳楑瘋篕撠B",
        "hong" : "粹綻粽箄箇裼精",
        "hu"   : "誥綺綬誘綱斀銊碨",
        "hua"  : "趙貌緡鳹賒",
        "ji"   : "儅憤撳撮僻撞摯價摩暮槨撫樟憚數播撬暱戮憎暴敷鰜艟諃僄撒磭晱痤鬌諗艗",
        "jin"  : "踢輛踏輪踞踩暌隤",
        "jing" : "器噙儐冪噩儔噱噹儕劓劑噥噫噤麾黎噪儥麩",
        "jian" : "膝膛獗膘潔潤澄潟翩",
        "jiang": "蔚蔭銈誸",
        "jie"  : "豌誹賜諂論賡趣賣豎礡",
        "jun"  : "縑澱歙澡縈縞氅鶀",
        "kan"  : "膳磟臻搢",
        "kang" : "艙蕊蕩",
        "ke"   : "褫親褪覦豍耤髣",
        "kuang": "選錠",
        "lang" : "檄檢檀斃蓔搮",
        "li"   : "盪燭爵燴瞳蕾薯璨獰燮璦璩薑魦薛",
        "lian" : "蟀薊褶褻螻螳蟆憟",
        "liang": "謎謠褸講謝搮",
        "lin"  : "還遽矔",
        "ling" : "鍔鍛鍬鍵錘濩",
        "lu"   : "罈繚糧翹簧織蜚齘繕",
        "mao"  : "籀簸簷簸礄穫簾鋆",
        "miao" : "穔鏈樍",
        "ming" : "隴霧霪",
        "nan"  : "撉鰍",
        "ning" : "譴籠撣",
        "pian" : "醳",
        "pin"  : "",
        "pei"  : "鑠驚驛閜鼒屩鰬",
        "qi"   : "猺頧糔磹玁詒",
        "qian" : "棡塉繶",
        "qiang": "嚘卻",
        "qin"  : "鼪",
        "qing" : "",
        "qu"   : "蛨鐨",
        "ran"  : "",
        "ren"  : "嵀鯃",
        "rong" : "慓橝蹀",
        "ruo"  : "鵩",
        "sha"  : "伈伢价鰨",
        "shan" : "刓囡冱匟趉",
        "shang": "奻妀奾毈",
        "shen" : "旮机朸扠氘統揧",
        "shi"  : "呇妢坒奀坋岍尪坅宎尨巠嚍",
        "shu"  : "忴攷抎扲旰扴忺忷扺旵旴抁抈旲芊噌",
        "shui" : "阨",
        "si"   : "佷佴佪侗擫佸侒",
        "song" : "侂佮刵愬慡靾騊",
        "tai"  : "怍怮怢緧瑀",
        "tang" : "斻昉閰",
        "tao"  : "旽杬昑頨懧",
        "tong" : "苀籵肮肵肸欹",
        "tian" : "毞蓇蝀",
        "tie"  : "沺泃",
        "ting" : "穻穸礿泭泆祂鰝霝",
        "wan"  : "剄俀侺侹僊",
        "wei"  : "怹峚帡峎哏峇帠勴峏誺峈",
        "wen"  : "恅恌",
        "wu"   : "挔昜昢挕敁拻拵絑堧拺昡",
        "xi"   : "昹炟柈昝炴浀殽懥洇",
        "xiao" : "苤苠僶虷窀苳祋緗苺",
        "xian" : "疧珆玿瓬玵",
        "xiang": "矨眈砏矧砆盷翬",
        "xiong": "倱傴倯",
        "xu"   : "哢剕剞唗剚唚睄袺懠鼖",
        "xue"  : "悝穘",
        "yang" : "栺栥栠歭栝栔儩鮆栒",
        "yi"   : "砱眢砩甡砫畛痁眓砳砱皊痀眙祒秫砯砪禊嶷疺疰瘏畹亄騑澞砣潳秬",
        "yin"  : "笐秪竘窅秞窌窉媟捈秭",
        "ying" : "茬荎荌荓踕茼茖菻茈",
        "you"  : "衭蚅蚙衵蚡歖衃",
        "yong" : "蚋蚗",
        "yu"   : "趷郙唲迶迾逄啎迼豗郤迻迿郖酐銴适郘趵媢訒堮唹啥鍠嬥穛",
        "zhi"  : "眳秶祫硉眭窐祡秷祩眻笥硒砦离皏祤秸剺祪菑笵濻秺",
        "zhong": "笢笳笘笪",
        "zhou" : "笣笸遶鏾絅",
        "zhu"  : "罣蚺絊翍鬊",
        "zhuo" : "觖觖袛袬慦簀萿壏袓",
        "zi"   : "赻赽訧觕豜訬谻儚濼",
        "zong" : "跁駏",
        "zu"   : "逋逜逌逑",
        "zuo"  : "釬酘酚鯗娾",
]);

//笢貌躓靡ㄗ踏綴樟哿氝樓ㄛ眕猿蜓曹趙ㄘ
mapping cn_pwname = ([
        "ai"   : "乾磃閮",
        "bin"  : "斖誽",
        "chun" : "景曾搎",
        "dan"  : "竣楎",
        "fang" : "滂",
        "fei"  : "滑漦醵鰣",
        "fen"  : "煌煉誽蹡",
        "feng" : "瘀瑯",
        "hong" : "綻箇搹裼",
        "jiao" : "蝙瘥藂",
        "juan" : "樽暸橫銝",
        "ju"   : "擅",
        "ke"   : "褫豍",
        "lan"  : "擘嵹懦擠黖",
        "li"   : "璨獲燧燮璩棖瞬瑆",
        "lian" : "虧蟒",
        "ling" : "鍍轅鍊鍾鎂錘鍋嗙蝐酃",
        "man"  : "霤雞覤",
        "mei"  : "藥藤藝繭摁馽",
        "na"   : "饑馨",
        "qi"   : "踮踛",
        "qin"  : "嗛蘉",
        "qian" : "棡玹傮敶塉",
        "qing" : "",
        "ping" : "瘜",
        "rou"  : "",
        "ting" : "磌楯",
        "wen"  : "鰫恇頝",
        "xia"  : "牳閬",
        "xian" : "珈",
        "xiang": "眅盻盷蝵",
        "xin"  : "黹釔",
        "xiu"  : "凎凈凅",
        "xue"  : "悕",
        "yan"  : "栻桏捈駇潾禡踙醐僁",
        "ying" : "荎踕荓搡楂雓茷",
        "yu"   : "迶璆銴",
        "yue"  : "堎",
        "zhen" : "湴淩淔鶇",
        "zhu"  : "紩",
]);

string make_cn_name()
{
        string *ks_cn_sname, *ks_cn_pname;
        string fir_name, sec_name, result_name;
        int iname;

        string *new_sname;
        string *new_pname;

        new_sname = ({
                "麼", "睿", "迵", "樓", "熬", "傚", "壺", "羲", "絞", "載", "毞狟", "朒酴",
                "毀崞", "祫郬", "党旯", "侗芺", "啞迶", "儐殎",
        });

        new_pname = ({
                "麼", "珛", "珧", "炵", "聒崞", "痲", "啖濬", "橾崞",
        });

        ks_cn_sname = keys(cn_sname);
        ks_cn_pname = keys(cn_pname);

        // 30%蚚陔腔俷
        if (random(10) < 3)
                fir_name = new_sname[random(sizeof(new_sname))];
        else
                fir_name = ks_cn_sname[random(sizeof(ks_cn_sname))]; // 俷

        // 靡
        // 30%蚚陔腔靡
        if (random(10) < 3)
                sec_name = new_pname[random(sizeof(new_pname))];
        else
        {
                sec_name = ks_cn_pname[random(sizeof(ks_cn_pname))];
                sec_name = cn_pname[sec_name];
                sec_name = sec_name[(random(sizeof(sec_name)) & 0xFFFE)..<1];
                sec_name = sec_name[0..1];
        }

        // 1/10 撓薹蚚杅趼笢恅測杸
        if (random(10) == 1)
        {
                sec_name = chinese_number(random(100));
        }

        result_name = fir_name + sec_name;

        return result_name;
}

void generate_cn_name(object ob)
{
        string sname, pname, pname2, id1, id2;
        string *ks, *kp;

        ks = keys(cn_sname);
        kp = keys(cn_pname);
        sname = ks[random(sizeof(ks))];
        for (;;)
        {
                pname = kp[random(sizeof(kp))];
                if (pname != cn_sname[sname]) break;
        }
        id1 = cn_sname[sname];

        id2 = pname;
        pname = cn_pname[pname];
        pname = pname[(random(sizeof(pname)) & 0xFFFE)..<1];
        pname = pname[0..1];
        if (random(3) == 0)
        {
                for (;;)
                {
                        pname2 = kp[random(sizeof(kp))];
                        if (pname2 != cn_sname[sname] &&
                            pname2 != pname) break;
                }
                id2 += pname2;
                pname2 = cn_pname[pname2];
                pname2 = pname2[(random(sizeof(pname2)) & 0xFFFE)..<1];
                pname2 = pname2[0..1];
        } else
                pname2 = "";

        if (ob) ob->set_name(sname + pname + pname2,
                             ({ id1 + " " + id2, id1, id2 }));
}

mapping get_cn_name()
{
        string sname, pname, pname2, id1, id2;
        string *ks, *kp;

        ks = keys(cn_sname);
        kp = keys(cn_pname);
        sname = ks[random(sizeof(ks))];
        id1 = cn_sname[sname];
        for (;;)
        {
                pname = kp[random(sizeof(kp))];
                if (pname != id1 &&
                    ! find_living(id1 + " " + pname))
                        break;
        }

        id2 = pname;
        pname = cn_pname[pname];
        pname = pname[(random(sizeof(pname)) & 0xFFFE)..<1];
        pname = pname[0..1];
        if (random(3) == 0)
        {
                for (;;)
                {
                        pname2 = kp[random(sizeof(kp))];
                        if (pname2 != id1 && pname2 != pname &&
                            ! find_living(id1 + " " + pname + pname2)) break;
                }
                id2 += pname2;
                pname2 = cn_pname[pname2];
                pname2 = pname2[(random(sizeof(pname2)) & 0xFFFE)..<1];
                pname2 = pname2[0..1];
        } else
                pname2 = "";

        return ([ "name" : sname + pname + pname2,
                  "id"   : ({ id1 + " " + id2, id1, id2, }), ]);
}
